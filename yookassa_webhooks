–Ø –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ÆKassa –ø–æ –≤–µ–±—Ö—É–∫–∞–º. –í–æ—Ç –≤—Å—è –∫–ª—é—á–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é API, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.

### üìå –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä

–í–µ–±—Ö—É–∫–∏ (–≤—Ö–æ–¥—è—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π, –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –°–ø–æ—Å–æ–± –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–µ—Ç–æ–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ.

### üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–∞, –≤—ã–±–æ—Ä –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–∞—à–∏–º –ø–ª–∞—Ç–µ–∂–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º.

| –ú–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ | –ü–ª–∞—Ç–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ | –°–ø–æ—Å–æ–± –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| :--- | :--- | :--- |
| **HTTP Basic Auth** | –û–±—ã—á–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏, –≤—ã–ø–ª–∞—Ç—ã, –°–ø–ª–∏—Ç–æ–≤–∞–Ω–∏–µ, –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–¥–µ–ª–∫–∞ | **–ß–µ—Ä–µ–∑ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç** –ÆKassa (—Ä–∞–∑–¥–µ–ª "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è" ‚Üí "HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è") |
| **OAuth 2.0** | –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ | **–¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API** |

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ URL (–æ–±—â–∏–µ –¥–ª—è –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤)
*   **–ü—Ä–æ—Ç–æ–∫–æ–ª:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ **HTTPS**.
*   **–ü–æ—Ä—Ç:** –¢–æ–ª—å–∫–æ **443** –∏–ª–∏ **8443**.
*   **TLS/SSL:** –í–µ—Ä—Å–∏—è 1.2 –∏–ª–∏ –≤—ã—à–µ. –ü–æ–¥–æ–π–¥–µ—Ç –ª—é–±–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–æ—Ç —Ü–µ–Ω—Ç—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π).

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (HTTP Basic Auth)

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ HTTP Basic Auth, –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.
1.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**.
2.  –£–∫–∞–∂–∏—Ç–µ **URL –≤–∞—à–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞**.
3.  –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è, –∏–∑ —Å–ø–∏—Å–∫–∞.
4.  –ß—Ç–æ–±—ã –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è, –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ —Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ.

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏–µ `payment_method.active` –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –º–µ–Ω–µ–¥–∂–µ—Ä—É –ÆKassa.

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ API (OAuth 2.0)

–ï—Å–ª–∏ –≤—ã —É—á–∞—Å—Ç–Ω–∏–∫ –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ OAuth, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ API.

#### üì§ –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞ (–ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –∏ OAuth-—Ç–æ–∫–µ–Ω–∞ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç `webhook`.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (cURL):**
```bash
curl https://api.yookassa.ru/v3/webhooks \
  -X POST \
  -H 'Authorization: Bearer <–≤–∞—à_oauth_—Ç–æ–∫–µ–Ω>' \
  -H 'Idempotence-Key: <—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_–∫–ª—é—á_–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏>' \
  -H 'Content-Type: application/json' \
  -d '{
        "event": "payment.succeeded",
        "url": "https://–≤–∞—à-—Å–∞–π—Ç.ru/path/to/webhook"
      }'
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞:**
*   `event` (string): –ö–æ–¥ —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `payment.succeeded`).
*   `url` (string): URL, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "id": "wh-e44e8088-bd73-43b1-959a-954f3a7d0c54",
  "event": "payment.succeeded",
  "url": "https://–≤–∞—à-—Å–∞–π—Ç.ru/path/to/webhook"
}
```

#### üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ OAuth-—Ç–æ–∫–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ **GET** –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ç–æ—Ç –∂–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç:
```bash
curl https://api.yookassa.ru/v3/webhooks \
  -X GET \
  -H 'Authorization: Bearer <–≤–∞—à_oauth_—Ç–æ–∫–µ–Ω>'
```

#### ‚ùå –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞ (–æ—Ç–ø–∏—Å–∫–∞ –æ—Ç —Å–æ–±—ã—Ç–∏—è)
–î–ª—è –æ—Ç–ø–∏—Å–∫–∏ –æ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤—å—Ç–µ **DELETE** –∑–∞–ø—Ä–æ—Å, —É–∫–∞–∑–∞–≤ –≤ URL –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–µ–±—Ö—É–∫–∞.
```bash
curl https://api.yookassa.ru/v3/webhooks/{webhook_id} \
  -X DELETE \
  -H 'Authorization: Bearer <–≤–∞—à_oauth_—Ç–æ–∫–µ–Ω>'
```

### üì® –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
–í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç **POST-–∑–∞–ø—Ä–æ—Å–æ–º** –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤–∞–º–∏ URL –∏ –∏–º–µ—é—Ç –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```json
{
  "type": "notification",
  "event": "payment.succeeded",
  "object": {
    // –î–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–∞ (–ø–ª–∞—Ç–µ–∂–∞, –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ —Ç.–¥.) –≤ –º–æ–º–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞.
    // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ–±—ä–µ–∫—Ç–æ–º –≤ –æ—Å–Ω–æ–≤–Ω–æ–º API.
  }
}
```

#### –í–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏
1.  **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è:** –í–∞—à —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –≤—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞—Ç—å **HTTP —Å—Ç–∞—Ç—É—Å–æ–º 200**. –õ—é–±–æ–π –¥—Ä—É–≥–æ–π –∫–æ–¥ –±—É–¥–µ—Ç —Ä–∞—Å—Ü–µ–Ω–µ–Ω –∫–∞–∫ –æ—à–∏–±–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏, –∏ –ÆKassa –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏:** –ö—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ—Ç –ÆKassa.
    *   **–ü—Ä–æ–≤–µ—Ä–∫–∞ IP-–∞–¥—Ä–µ—Å–∞:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –ø—Ä–∏—à–µ–ª —Å –æ–¥–Ω–æ–≥–æ –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö IP –ÆKassa (–Ω–∞–ø—Ä–∏–º–µ—Ä, `185.71.76.0/27`, `77.75.153.0/25`, `2a02:5180::/32`). –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–∫–∞–∑–∞–Ω –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
    *   **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–±—ä–µ–∫—Ç–∞:** –ó–∞–ø—Ä–æ—Å–∏—Ç–µ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –æ–±—ä–µ–∫—Ç–∞ –ø–æ –µ–≥–æ `id` —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–µ API –ÆKassa –∏ —Å–≤–µ—Ä—å—Ç–µ –µ–≥–æ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å –ø–æ–º–æ—â—å—é SDK
–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ SDK. –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –Ω–∞ PHP:
```php
// 1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
$source = file_get_contents('php://input');
$requestBody = json_decode($source, true);

// 2. –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ–±—ã—Ç–∏—è
use YooKassa\Model\Notification\NotificationSucceeded;
if ($requestBody['event'] === 'payment.succeeded') {
    $notification = new NotificationSucceeded($requestBody);
}

// 3. –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç –ø–ª–∞—Ç–µ–∂–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã
$paymentObject = $notification->getObject();
```

### üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
–°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è. –ö–ª—é—á–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è:

| –°–æ–±—ã—Ç–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `payment.waiting_for_capture` | –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–∑–∞—Ö–≤–∞—Ç–∞) |
| `payment.succeeded` | –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –¥–µ–Ω—å–≥–∏ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã |
| `payment.canceled` | –ü–ª–∞—Ç–µ–∂ –æ—Ç–º–µ–Ω–µ–Ω |
| `refund.succeeded` | –í–æ–∑–≤—Ä–∞—Ç —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω |

–ü–æ–ª–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å–æ –≤—Å–µ–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π (–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–¥–µ–ª–∫–∞, –í—ã–ø–ª–∞—Ç—ã –∏ –¥—Ä.) —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

–ï—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –Ω–∞—á–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é, —É—Ç–æ—á–Ω–∏—Ç–µ, –∫–∞–∫–æ–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏ –º–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ ‚Äî —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.